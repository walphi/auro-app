# React SPA Multi-Page Rendering Implementation Plan

## Goal
Update the React SPA (`sites/src`) to render the new luxury multi-page agent site structure generated by Claude, with proper routing for Home, About, Listings, and Contact pages.

---

## User Review Required

> [!IMPORTANT]
> The current frontend only fetches `agentconfigs` data. The new AI-generated document is stored in `agent_site_documents`. We need to decide:
> 1. Fetch document from `agent_site_documents` (richer AI content), OR
> 2. Keep fetching `agentconfigs` and add a fallback if no document exists.
>
> **Recommendation**: Fetch `agent_site_documents` for live sites (contains the full `site`, `nav`, `pages` structure); fall back to basic `agentconfigs` rendering if document missing.

---

## Proposed Changes

### Backend API

#### [MODIFY] [get-agent-site.ts](file:///c:/Users/phill/Downloads/2025/Auro%20App/netlify/functions/get-agent-site.ts)
- Fetch the latest `agent_site_documents` row for the agent (by `slug`, ordered by `version desc`)
- Return merged data: `{ config, document }` so frontend has both raw config and AI content
- Fallback: if no document exists, return just `config` for backward compatibility

---

### Frontend Routing

#### [MODIFY] [App.tsx](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/App.tsx)
- Update routes to support multi-page navigation:
  - `/:slug` → Home page (page id: "home")
  - `/:slug/about` → About page
  - `/:slug/listings` → Listings page  
  - `/:slug/contact` → Contact page
- Pass page context to `AgentSite` component

---

### Main Site Component

#### [MODIFY] [AgentSite.tsx](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/components/AgentSite.tsx)
- Accept `pageId` prop from router (default: "home")
- Fetch full document from API
- Extract current page from `document.pages` array
- Apply design system from `document.site.designSystem`
- Render `<Navigation>` using `document.nav.items`
- Render page sections using a `<SectionRenderer>` component

---

### New Components

#### [NEW] [Navigation.tsx](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/components/Navigation.tsx)
- Renders navigation bar from `nav.items` array
- Handles internal routing using `react-router-dom` `Link`
- Supports sticky header with luxury styling

#### [NEW] [SectionRenderer.tsx](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/components/SectionRenderer.tsx)
- Maps section `type` to corresponding component:
  - `hero` → `<HeroSection />`
  - `about` → `<AboutSection />`
  - `services` → `<ServicesSection />`
  - `listingsGrid` → `<ListingsGridSection />`
  - `testimonials` → `<TestimonialsSection />`
  - `contact` → `<ContactSection />`
  - `ctaBand` → `<CTABandSection />`
  - `stats` → `<StatsSection />`
  - `focusAreas` → `<FocusAreasSection />`
  - default → generic fallback

#### [NEW] [sections/HeroSection.tsx](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/components/sections/HeroSection.tsx)
- Full-bleed hero with headline, subheadline, CTA button
- Uses design system colors and typography

#### [NEW] [sections/ListingsGridSection.tsx](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/components/sections/ListingsGridSection.tsx)
- Grid of property cards (reuse existing listing card logic)
- Pulls from `document.listings` array

#### [NEW] [sections/ContactSection.tsx](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/components/sections/ContactSection.tsx)
- Contact form with WhatsApp CTA integration
- Location info if available

*(Additional section components as needed)*

---

### Styling

#### [MODIFY] [AgentSite.css](file:///c:/Users/phill/Downloads/2025/Auro%20App/sites/src/components/AgentSite.css)
- Apply design system variables from `document.site.designSystem`
- Add luxury styling: generous whitespace, elegant typography, subtle animations
- Ensure mobile responsiveness

---

## Verification Plan

### Manual Browser Test
1. Deploy changes to Netlify (automatic on push)
2. Navigate to `https://auroapp.com/sites/phillip-walsh`
3. Verify:
   - Home page renders with Hero, listings preview, and CTA
   - Navigation shows Home, About, Properties, Contact links
   - Click "About" → navigates to `/sites/phillip-walsh/about`
   - Click "Properties" → shows listings grid
   - Click "Contact" → shows contact form
   - Design matches luxury aesthetic (colors, fonts from AI)

### API Verification
- Call `GET /.netlify/functions/get-agent-site?slug=phillip-walsh`
- Confirm response includes both `config` and `document` (with `pages` array)

---

## Implementation Order
1. Update `get-agent-site.ts` to return document data
2. Update `App.tsx` with multi-page routes
3. Create `SectionRenderer.tsx` and basic section components
4. Create `Navigation.tsx`
5. Update `AgentSite.tsx` to orchestrate everything
6. Style refinements for luxury look
7. Test full flow
